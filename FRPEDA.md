# 聊一聊FRP和EDA
## EDA
### EDA定义

Gartner在2003年引入了一个新术语事件驱动架构（Event Driven Architecture，EDA), 主要用于描述一种基于事件的范例。EDA 是一种用于进行设计和实现应用和系统的方法—在这些应用和系统里, 事件所触发的消息可以在独立的、非耦合的组件和服务之间传递，这些模块彼此并不知晓对方。这些应用程序中的EDA极大地改进了企业或政府响应不同的、表面上毫无关联事件的能力。通过提供瞬时过滤、聚合和关联事件的能力，EDA可以快速地检测出事件并判断它的类型，从而帮助组织机构快速、恰当地响应和处理这些事件。通常事件可以采用发布/订阅机制。

### 事件驱动架构概述

一个事件驱动框架（EDA）定义了一个设计和实现一个应用系统的方法学，在这个系统里事件可传输于松散耦合的组件和服务之间。一个事件驱动系统典型地由事件消费者和事件产生者组成。事件消费者向事件管理器订阅事件，事件产生者向事件管理器发布事件。当事件管理器从事件产生者那接收到一个事件时，事件管理把这个事件转送给相应的事件消费者。如果这个事件消费者是不可用的，事件管理者将保留这个事件，一段间隔之后再次转送该事件消费者。这种事件传送方法在基于消息的系统里就是:储存（store）和转送（forward）。

构建一个包含事件驱动构架的应用程序和系统，会使这些应用程序和系统响应更灵敏，因为事件驱动的系统更适合应用在不可预知的和异步的环境里。

事件驱动架构在具体实现中是指由一系列相关组件构成的应用，而组件之间通过事件机制完成一定的业务功能。由于在一个EDA系统中各个组件都只专注于处理输入的消息与发布输出的消息，因而EDA系统能够更有加效地对管道化（pipelined）的、由多软件模块链接而成的并发事件流（concurrent processing of events）进行处理。

### EDA特点
EDA系统中各组件以异步方式响应事件，在本质上是可以并行的，因而在政府部门的电子政务应用中具有极大的优势。其具备以下特点:

    ◆ 并发执行

    ◆ 事件触发/数据触发/时间规则触发

    ◆ 实时/增量响应

    ◆ 分布式事件系统处理

上述特点能很好地满足政府部门应用需求，如跨部门的应急联动系统或联合监管协同服务等应用。

从目前情况来看，EDA系统还只是处理简单事件的系统，对于复杂事件的处理还有待进一步的研究。但是，EDA仍然能作为SOA系统的一个有效补充，弥补SOA系统的一些不足，如实时响应度不够。

### 事件驱动架构优势

事件驱动设计和开发所提供的优势如下所示:

> ◆ EDA提高了对不断变化的业务需求的响应，最大限度地减少了对现有业务应用的影响，也常消除了对新打包应用的需要。如果采用特有的粗颗粒服务模型可以基于业务目标快速确定可控的业务变更，并直接、迅速、有效地实施变更以达到业务敏捷性和完整性。

> ◆ 可以更容易开发和维护大规模分布式应用程序和不可预知的服务或异步服务;

> ◆ 可以很容易，低成本地集成、再集成、再配置新的和已存在的应用程序和服务。

> ◆ 促进远程组件和服务的再使用，拥有一个更灵敏、没有Bug的开发环境。

从时间维度来看EDA的优势:

> ◆ 短期利益:更容易定制，因为设计对动态处理有更好的响应;

> ◆ 长期利益:系统和组织的状态变得更精准，对实时变化的响应接近于同步。
    


##### EDA和SOA之间的关系：

SOA和EDA是平等和互补的。所以，我不认同那些努力传播SOA的同学们所说的“EDA只是SOA的一个子集”的论断。一个更广泛的事件驱动架构概念，不仅是超越事件驱动SOA的，还应该包括实时信息流和分析，以及复杂事件处理。

当EDA认为事件是系统中最重要的组成时，你最好注意那些组件或者服务，以及组件之间的‘通道’”

与Request/Response系统不同的是，要求请求者必须明确发送请求信息，而事件驱动架构提供一个机制去动态响应事件。在一个EDA系统里，事件产生者发布事件，事件消费者接受事件。

业务系统可以从SOA和EDA中受益匪浅，因为事件发生时EDA系统能触发事件消费者，SOA服务可以快速地从相同的消费者中访问、查询。系统要求有最高的响应性，当事件被触发时这个系统必须能快速决定必须的动作。到事件结束，事件应该被发布和消费，而且事件要穿越SOA所有的边界，包括整个体系结构和物理层。

系统要有最高的响应性，当事件触发时这个系统必须能快速决定必须的动作。到事件结束，事件应该被发布和消费，而且事件要穿越SOA所有的边界，包括整个体系结构和物理层。
    
###     ESB连接EDA和SOA
企业服务总线(Enterprise Service Bus，ESB)在异类平台和环境间建立联系，充当允许不同应用程序进程之间进行通信的中间层。部署到企业服务总线的服务可以由使用者或事件触发。它同时支持同步方式和异步方式，可促进一个或多个参与者之间的交互。因此 ESB 可提供 SOA 和 EDA 范例的所有功能。“ESB提供了消息的传输，格式的转换等关键功能，为服务的请求者和服务提供者之间架设了沟通的桥梁，是企业应用基础架构的粘合剂。” 甲骨文公司大中华区高级技术经理黄建勇说。

企业服务总线可连接各个异类节点并作为中介传递其间的所有通信和交互，这些节点可分散在面向服务的体系结构(同步一对一方法)和事件驱动的体系结构(异步多对多方法)中。ESB 是目前处理集成挑战的最有效方法，是可提供最大业务灵活性和不同应用程序间的高效连接技术解决方案。

EDA应用在很多ESB（企业服务总线）产品中，比如FiornaoESB中间件产品支持同步、异步和请求响应事件，事件处理和传输实用不同的技术例如JMS，HTTP，电子邮件和基于XML的RPC等。比如“政府网上监察系统”通过对被监察对象（系统）数据的实时采集，通过EDA技术的事件触发，事件过滤，实现对违规、违法、越权行政、超时限行政等问题进行通知和督办等。

### EDA应用方向

事件驱动架构(EDA)是分布式应用程序的普遍架构形式，非常典型的是:分布式应用程序都被设计成为模块化的、封装的、可共享事件服务的组件。能够通过应用程序、适配器以及无入侵性的代理操作来创建这些服务。

由于EDA的特点，在金融贸易、能源贸易、电信以及欺诈检测这些行业中，一直都在采用事件驱动架构(EDA)技术。近期在我国政府的电子政务建设中

利用EDA分布式处理架构的优势构建共享交换平台，实现跨部门、跨平台、跨应用系统的政务信息资源的共享与交换，并对政府应急系统和跨委办局之间的业务协同办公提供支撑和保障。
 
[EDA](http://tech.it168.com/a2009/0313/268/000000268470.shtml)

[Martin Fowler](https://martinfowler.com/articles/201701-event-driven.html)


---

## 响应式编程和响应式系统
响应式技术目前成功的标志之一是“响应式reactive”成为了一个热词，并且跟一些不同的事物与人联系在了一起——常常伴随着像“流streaming”、“轻量级lightweight”和“实时real-time”这样的词。
#### FRP
- [FRP定义](http://conal.net/papers/icfp97/)  


#### 响应式编程Reactive programming，

不要把它跟函数响应式编程混淆了，它是异步编程下的一个子集，也是一种范式，在这种范式下，由新信息的有效性availability推动逻辑的前进，而不是让一条执行线程a thread-of-execution去推动控制流control flow。


响应式编程一般是事件驱动event-driven，相比之下，响应式系统则是消息驱动message-driven的


响应式编程的基本好处是：提高多核和多 CPU 硬件的计算资源利用率；根据阿姆达尔定律以及引申的 Günther 的通用可伸缩性定律Günther’s Universal Scalability Law 脚注3 ，通过减少序列化点serialization points来提高性能。

另一个好处是开发者生产效率，传统的编程范式都尽力想提供一个简单直接的可持续的方法来处理异步非阻塞式计算和 I/O。在响应式编程中，因活动(active)组件之间通常不需要明确的协作，从而也就解决了其中大部分的挑战。

响应式编程真正的发光点在于组件的创建跟工作流的组合。为了在异步执行上取得最大的优势，把 反压back-pressure加进来是很重要，这样能避免过度使用，或者确切地说，避免无限度的消耗资源。




##### 事件驱动 && 消息驱动
响应式编程——专注于短时间的数据流链条上的计算——因此倾向于事件驱动，而响应式系统——关注于通过分布式系统的通信和协作所得到的弹性和韧性——则是消息驱动的 脚注4 （或者称之为 消息式messaging 的）。

一个拥有长期存活的可寻址long-lived addressable组件的消息驱动系统跟一个事件驱动的数据流驱动模型的不同在于，消息具有固定的导向，而事件则没有。消息会有明确的（一个）去向，而事件则只是一段等着被观察observe的信息。另外，消息式messaging更适用于异步，因为消息的发送与接收和发送者和接收者是分离的。


>一条消息就是一则被送往一个明确目的地的数据。一个事件则是达到某个给定状态的组件发出的一个信号。在一个消息驱动系统中，可寻址到的接收者等待消息的到来然后响应它，否则保持休眠状态。在一个事件驱动系统中，通知的监听者被绑定到消息源上，这样当消息被发出时它就会被调用。这意味着一个事件驱动系统专注于可寻址的事件源而消息驱动系统专注于可寻址的接收者。



#### 响应式系统
响应式系统的基石是消息传递message-passing，消息传递为两个组件之间创建一条暂时的边界，使得它们能够在 时间 上分离——实现并发性——和 空间space ——实现分布式distribution与移动性mobility。这种分离是两个组件完全 隔离isolation以及实现 弹性resilience和 韧性elasticity基础的必需条件。



#### 响应式系统&&响应式编程

响应式编程是一种管理内部逻辑internal logic和数据流转换dataflow transformation的好技术，在本地的组件中，做为一种优化代码清晰度、性能以及资源利用率的方法。响应式系统，是一组架构上的原则，旨在强调分布式信息交流并为我们提供一种处理分布式系统弹性与韧性的工具。

响应式编程是一个非常有用的实现技术，可以用在响应式架构当中。但是记住这只能帮助管理一部分：异步且非阻塞执行下的数据流管理——通常只在单个结点或服务中。当有多个结点时，就需要开始认真地考虑像数据一致性data consistency、跨结点沟通cross-node communication、协调coordination、版本控制versioning、编制orchestration、错误管理failure management、关注与责任concerns and responsibilities分离等等的东西——也即是：系统架构。




#### 事件驱动架构
事件驱动架构(EDA)是分布式应用程序的普遍架构形式，非常典型的是:分布式应用程序都被设计成为模块化的、封装的、可共享事件服务的组件。能够通过应用程序、适配器以及无入侵性的代理操作来创建这些服务。由于EDA的特点，在金融贸易、能源贸易、电信以及欺诈检测这些行业中，一直都在采用事件驱动架构(EDA)技术。近期在我国政府的电子政务建设中，利用EDA分布式处理架构的优势构建共享交换平台，实现跨部门、跨平台、跨应用系统的政务信息资源的共享与交换，并对政府应急系统和跨委办局之间的业务协同办公提供支撑和保障。

EDA应用在很多ESB（企业服务总线）产品中，比如FiornaoESB中间件产品支持同步、异步和请求响应事件，事件处理和传输实用不同的技术例如JMS，HTTP，电子邮件和基于XML的RPC等。比如“政府网上监察系统”通过对被监察对象（系统）数据的实时采集，通过EDA技术的事件触发，事件过滤，实现对违规、违法、越权行政、超时限行政等问题进行通知和督办等。

- [FRP定义](http://conal.net/papers/icfp97/)
- [事件驱动架构](https://baike.baidu.com/item/%E4%BA%8B%E4%BB%B6%E9%A9%B1%E5%8A%A8%E6%9E%B6%E6%9E%84/883637)
- [响应式宣言](https://linux.cn/article-8773-1.html) 
- [The Reactive Manifesto](https://www.reactivemanifesto.org/glossary#Message-Driven)

- [EDA&&SOA](http://tech.it168.com/a2009/0313/268/000000268470.shtml)

